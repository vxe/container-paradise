# -*- mode: snippet -*-
# name: memcache-timeout-count
# key: memcache-timeout-count
# --
export EDGE=$1; for mc in \`for ip in {0001..${2:0005}}; do host mc$ip.$EDGE | perl -ne 'print "\$1\n" if /(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})/' | tr '\n' ' ' ; done\`; do rolename -l $mc; clush -w "api00[01-55].$EDGE" -B "cat /var/log/shepherd/API\=federator.log | grep memcache | grep timeout | grep $mc | wc -l"; done